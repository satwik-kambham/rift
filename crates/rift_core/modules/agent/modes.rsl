let prompts = import("agent/prompts.rsl")

# Agent mode contract:
# - `systemPrompt`: system prompt sent to the model.
# - `tools`: map of tool name -> approval policy used by `ui/agent.rsl`.
#   - `true`: tool call is queued in `pending_tool_calls` and requires explicit user approval.
#   - `false`: tool call is auto-executed without prompting.
# Omitted tools are unavailable to the model for that mode.

# Minimal Mode

export minimal = createTable()
minimal["displayName"] = "Minimal"
minimal["systemPrompt"] = ""
minimal["tools"] = fromJson("{}")

# Plan Mode

export plan = createTable()
plan["displayName"] = "Plan"
plan["systemPrompt"] = prompts["planSystemPrompt"]
plan["tools"] = fromJson("{
    \"run_shell_command\": true,
    \"read_file\": false,
    \"search_workspace\": false,
    \"find_file\": false
}")

# Edit Mode

export edit = createTable()
edit["displayName"] = "Edit"
edit["systemPrompt"] = prompts["editSystemPrompt"]
edit["tools"] = fromJson("{
    \"run_shell_command\": true,
    \"read_file\": false,
    \"search_workspace\": false,
    \"find_file\": false,
    \"write_file\": false,
    \"replace\": false
}")

# Canonical mode ordering used by UI mode cycling.
export all = createArray()
arrayPushBack(all, edit)
arrayPushBack(all, plan)
arrayPushBack(all, minimal)
